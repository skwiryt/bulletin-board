(this["webpackJsonpbulletin-board"]=this["webpackJsonpbulletin-board"]||[]).push([[0],{107:function(e,t,a){},112:function(e,t,a){},113:function(e,t,a){},116:function(e,t,a){},117:function(e,t,a){},118:function(e,t,a){},119:function(e,t,a){},132:function(e,t,a){e.exports=a(243)},242:function(e,t,a){},243:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),o=a.n(c),l=a(22),s=a(17),i=a(120),u=a(289),m=a(285),p=a(286),d=a(55),b=a(105),E=a(106),f={posts:{data:[],requests:{LOAD_POSTS:{active:!1,error:!1},ADD_POST:{active:!1,error:!1}}},user:{loggedIn:!0,id:"1234568",role:"user"}},h=a(34),v=a(121),O=a(8),g=a(60),j=a(36),y=a.n(j),x=a(51),_=a(52),P=a.n(_),S="https://portcharitystore.blob.core.windows.net/bulletin-board",N=function(e){return e.posts.data},T=function(e){return"app/".concat("posts","/").concat(e)},w=T("REQUEST_START"),C=T("REQUEST_SUCCESS"),A=T("REQUEST_ERROR"),D=T("LOAD_POSTS"),k=T("ADD_POST"),I=function(e){return{payload:e,type:w}},L=function(e){return{payload:e,type:C}},q=function(e){return{payload:e,type:A}},R={posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case k:return Object(O.a)(Object(O.a)({},e),{},{data:[].concat(Object(v.a)(e.data),[t.payload])});case D:return Object(O.a)(Object(O.a)({},e),{},{data:t.payload});case w:return Object(O.a)(Object(O.a)({},e),{},{requests:Object(O.a)(Object(O.a)({},e.requests),{},Object(h.a)({},t.payload,{active:!0,error:!1}))});case C:return Object(O.a)(Object(O.a)({},e),{},{requests:Object(O.a)(Object(O.a)({},e.requests),{},Object(h.a)({},t.payload,{active:!1,error:!1}))});case A:return Object(O.a)(Object(O.a)({},e),{},{requests:Object(O.a)(Object(O.a)({},e.requests),{},Object(h.a)({},t.payload,{active:!1,error:!0}))});default:return e}}};Object.keys(f).forEach((function(e){"undefined"==typeof R[e]&&(R[e]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e})}));var F=Object(d.combineReducers)(R),W=Object(d.createStore)(F,f,Object(E.composeWithDevTools)(Object(d.applyMiddleware)(b.a))),U=a(276),H=a(2),V=a(107),z=a.n(V),B=a(275),M=a(277),Q=function(e){return e.user},G=function(e){return"app/".concat("posts","/").concat(e)},J=(G("FETCH_START"),G("FETCH_SUCCESS"),G("FETCH_ERROR"),a(47)),Y=a.n(J),Z=a(272),X=Object(s.b)((function(e){return{user:Q(e)}}))((function(e){var t=e.className,a=e.user;return r.a.createElement("nav",{className:Object(H.a)(t,Y.a.root)},r.a.createElement(Z.a,{className:Y.a.link,exact:!0,to:"/",activeClassName:"active",component:l.c},"Home"),!a.loggedIn&&r.a.createElement(Z.a,{className:Y.a.link,href:"https://google.com",component:"a"},"Log in"),a.loggedIn&&r.a.createElement(Z.a,{className:Y.a.link,to:"/",component:l.b},"Log out"),a.loggedIn&&r.a.createElement(Z.a,{className:Y.a.link,exact:!0,to:"/userposts/".concat(a.id),activeClassName:"active",component:l.c},"My Posts"))})),$=function(e){var t=e.className;e.children;return r.a.createElement("div",{className:Object(H.a)(t,z.a.root)},r.a.createElement(B.a,null,r.a.createElement(U.a,null,r.a.createElement(M.a,null,r.a.createElement(X,null)))),r.a.createElement(U.a,null,r.a.createElement(M.a,null)))},K=a(112),ee=a.n(K),te=function(e){var t=e.className,a=e.children;return r.a.createElement("div",{className:Object(H.a)(t,ee.a.root)},r.a.createElement($,null),r.a.createElement(U.a,null,a))},ae=a(14),ne=a(31),re=a(33),ce=a(32),oe=a(113),le=a.n(oe),se=a(66),ie=a(279),ue=a(280),me=a(287),pe=a(288),de=a(292),be=a(290),Ee=a(278),fe=a(114),he=a.n(fe),ve=a(115),Oe=a.n(ve),ge=a(68),je=a.n(ge),ye=function(e){Object(re.a)(a,e);var t=Object(ce.a)(a);function a(){var e;Object(ne.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={post:Object(O.a)({},e.props.post),error:!1,sent:!1},e.handleChange=function(t){var a=t.target,n=e.state.post,r=a.name,c=a.value;e.setState({post:Object(O.a)(Object(O.a)({},n),{},Object(h.a)({},r,c))})},e.setImage=function(t){var a=e.state.post;t?e.setState({post:Object(O.a)(Object(O.a)({},a),{},{file:t[0]})}):e.setState({photo:Object(O.a)(Object(O.a)({},a),{},{file:null})})},e.clearError=function(){e.setState({error:null})},e.submitForm=function(t){var a=e.state.post,n=e.props.user;t.preventDefault();var r=null;if(a.title.length&&a.text.length&&a.email.length?a.title.length>25?r="Title can't be longer than 25 characters":a.title.length<10?r="Title can't be shorter than 10 characters":a.text.length<20?r="Text can't be shorter than 20 characters":Oe.a.isEmail(a.email)||(r="Enter valid email"):r="You can't leave title, text or email fields empty",r)e.setState({error:r});else{var c=new FormData;["email","text","title","phone","price","location"].forEach((function(e){c.append(e,a[e])})),c.append("author",n.id),a.file&&c.append("photo",a.file),e.props.submitAction(c),e.setState({error:null,sent:!0})}},e.render=function(){var t=e.props,a=t.className,n=t.request,c=e.state.post,o=c.title,l=c.text,s=c.email,i=c.phone,u=c.price,m=c.location,p=c.photo,d=c.file,b=e.state,E=b.error,f=b.sent,h=Object(se.a)(e),v=h.handleChange,O=h.setImage,g=h.submitForm,j=h.clearError,y=p||d?"Change image":"Choose image",x=p?{defaultImages:["".concat(S,"/").concat(p)]}:{};return r.a.createElement("div",{className:Object(H.a)(a,je.a.root)},r.a.createElement("form",null,f&&!n.active&&!n.error&&r.a.createElement(be.a,{severity:"success"},r.a.createElement(Ee.a,null,"Success"),"Your post has been successfully submitted!"),f&&n.error&&r.a.createElement(be.a,{severity:"error"},r.a.createElement(Ee.a,null,"Error"),"Request error"),E&&r.a.createElement(be.a,{severity:"error",onClose:j},r.a.createElement(Ee.a,null,"Error"),E),f&&n.active&&r.a.createElement(ie.a,null),!f&&r.a.createElement(ue.a,{container:!0,spacing:5},r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(me.a,{onChange:v,defaultValue:o,id:"title",name:"title",label:"Title",variant:"filled",fullWidth:!0}),r.a.createElement(me.a,{onChange:v,multiline:!0,defaultValue:l,id:"text",label:"Text",name:"text",variant:"filled",fullWidth:!0}),r.a.createElement(me.a,{onChange:v,defaultValue:s,id:"email",label:"Email",name:"email",variant:"filled",fullWidth:!0}),r.a.createElement(me.a,{onChange:v,defaultValue:i,id:"phone",label:"Phone",name:"phone",variant:"filled",fullWidth:!0}),r.a.createElement(me.a,{onChange:v,defaultValue:u,id:"price",label:"Price",name:"price",variant:"filled",fullWidth:!0}),r.a.createElement(me.a,{onChange:v,defaultValue:m,id:"location",label:"Location",name:"location",variant:"filled",fullWidth:!0}),r.a.createElement(pe.a,{component:"p",className:je.a.box},r.a.createElement(Z.a,{className:je.a.submitButton,onClick:g,variant:"contained",color:"primary"},"Submit"))),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(de.a,null,r.a.createElement(he.a,Object.assign({withIcon:!0,buttonText:y,imgExtension:[".jpg","jpeg",".png","svg"],maxFileSize:5242880,withPreview:!0,onChange:O,singleImage:!0},x)))))))},e}return a}(r.a.Component);ye.defaultProps={post:{id:"",title:"",text:"",email:"",phone:"",price:"",location:""}};var xe=Object(s.b)((function(e){return{user:Q(e)}}))(ye),_e=a(246),Pe=a(247),Se=a(69),Ne=a.n(Se),Te=function(e){var t=e.className,a=e.title;return r.a.createElement("div",{className:Object(H.a)(t,Ne.a.root)},r.a.createElement(_e.a,{className:Ne.a.titlePaper},r.a.createElement(Pe.a,{className:Ne.a.title,variant:"h3"},a)))},we=function(e){Object(re.a)(a,e);var t=Object(ce.a)(a);function a(){var e;Object(ne.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).editPost=function(e){var t,a=Object(g.a)(e.entries());try{for(a.s();!(t=a.n()).done;){var n=t.value;console.log(n[0]+", "+n[1])}}catch(r){a.e(r)}finally{a.f()}},e.render=function(){var t=e.props,a=t.className,n=t.post;return r.a.createElement("div",{className:Object(H.a)(a,le.a.root)},r.a.createElement(Te,{title:"Edit your post"}),r.a.createElement(xe,{post:n,submitAction:e.editPost}))},e}return a}(r.a.Component),Ce=Object(s.b)((function(e,t){return{post:N(e).find((function(e){return e.id===t.match.params.id}))}}))(we),Ae=a(116),De=a.n(Ae),ke=function(e){Object(re.a)(a,e);var t=Object(ce.a)(a);function a(){var e;Object(ne.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).render=function(){var t=e.props,a=t.className,n=t.addPost,c=t.request;return r.a.createElement("div",{className:Object(H.a)(a,De.a.root)},r.a.createElement(Te,{title:"Add new post"}),r.a.createElement(xe,{request:c,submitAction:n}))},e}return a}(r.a.Component),Ie=Object(s.b)((function(e){return{request:(t=e,a="ADD_POST",t.posts.requests[a])};var t,a}),(function(e){return{addPost:function(t){return e((a=t,function(){var e=Object(x.a)(y.a.mark((function e(t){var n,r,c,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(g.a)(a.entries());try{for(n.s();!(r=n.n()).done;)c=r.value,console.log(c[0]+", "+c[1])}catch(l){n.e(l)}finally{n.f()}return t(I("ADD_POST")),e.prev=3,e.next=6,P.a.post("/api/posts",a);case 6:o=e.sent,t({payload:o.data,type:k}),t(L("ADD_POST")),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),t(q("ADD_POST"));case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}()));var a}}}))(ke),Le=a(117),qe=a.n(Le),Re=function(e){var t=e.className,a=e.children;return r.a.createElement("div",{className:Object(H.a)(t,qe.a.root)},r.a.createElement("h2",null,"UserPosts"),a)},Fe=a(118),We=a.n(Fe),Ue=a(281),He=a(282),Ve=a(283),ze=a(284),Be=a(70),Me=a.n(Be),Qe=Object(s.b)((function(e){return{user:Q(e)}}))((function(e){var t=e.className,a=e.posts,n=e.user;return r.a.createElement("div",{className:Object(H.a)(t,Me.a.root)},r.a.createElement(ue.a,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center"},r.a.createElement(Pe.a,{className:Me.a.title,variant:"h4"},"Pick a post for details"),n.loggedIn&&r.a.createElement(Z.a,{to:"/post/add",component:l.b},"Add new post")),r.a.createElement(_e.a,{className:Me.a.component},r.a.createElement(Ue.a,null,r.a.createElement(He.a,null,a.map((function(e){return r.a.createElement(Ve.a,{key:e.id},r.a.createElement(ze.a,null,r.a.createElement(Z.a,{to:"/post/".concat(e.id),component:l.b},e.title)))}))))))})),Ge=Object(s.b)((function(e){return{posts:N(e).map((function(e){return{id:e.id,title:e.title}}))}}),(function(e){return{loadPosts:function(t){return e((a=t,console.log("loadPostsRequest thunk is called, and !loadedPosts.length: ",!a.length),"undefined"===typeof a||a.length?function(e){e(L("LOAD_POSTS"))}:function(){var e=Object(x.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("dispatch for fetch fired by Thunk"),t(I("LOAD_POSTS")),e.prev=2,e.next=5,P.a.get("/api/posts");case 5:a=e.sent,t({payload:a.data,type:D}),t(L("LOAD_POSTS")),console.log("response.data: ",a.data),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),t(q("LOAD_POSTS"));case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()));var a}}}))((function(e){Object(n.useEffect)((function(){var t=e.posts,a=e.loadPosts;console.log("posts.length in render: ",t.length),a(t)}),[]);var t=e.className,a=e.posts;return r.a.createElement("div",{className:Object(H.a)(t,We.a.root)},r.a.createElement(Te,{title:"All posts chronologically"}),r.a.createElement(Qe,{posts:a}))})),Je=a(26),Ye=a.n(Je),Ze=function(e){Object(re.a)(a,e);var t=Object(ce.a)(a);function a(){var e;Object(ne.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={post:{},error:!1,imageLoaded:!1},e.componentDidMount=function(){(function(){var t=Object(x.a)(y.a.mark((function t(){var a;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,P.a.get("/api/posts/"+e.props.match.params.id);case 3:a=t.sent,e.setState(Object(O.a)(Object(O.a)({},e.state),{},{post:a.data,error:!1})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.setState(Object(O.a)(Object(O.a)({},e.state),{},{error:!0}));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()},e.setImageLoaded=function(t){e.setState(Object(O.a)(Object(O.a)({},e.state),{},{imageLoaded:t}))},e.render=function(){var t=e.props,a=t.className,n=t.user,c=e.state,o=c.post,s=c.error,i=c.imageLoaded;return r.a.createElement("div",{className:Object(H.a)(a,Ye.a.root)},s&&r.a.createElement(be.a,{severity:"error"},r.a.createElement(Ee.a,null,"Error")),r.a.createElement(_e.a,{className:Ye.a.titlePaper},r.a.createElement(Pe.a,{className:Ye.a.title,variant:"h4"},"Post: ",o.title,n.loggedIn&&("admin"===n.role||n.id===o.author)&&r.a.createElement(Z.a,{className:Ye.a.edit,to:"/post/".concat(o.id,"/edit"),component:l.b},"EDIT"))),r.a.createElement(ue.a,{container:!0,spacing:5},r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement("div",{className:Ye.a.image},o.photo&&!i&&r.a.createElement("div",{className:Ye.a.placeholder},"Loading..."),o.photo&&r.a.createElement("img",{onLoad:function(){return e.setImageLoaded(!0)},className:i?Ye.a.visible:Ye.a.hidden,src:"".concat(S,"/").concat(o.photo),alt:"announcement"}),!o.photo&&r.a.createElement("div",{className:Ye.a.placeholder},"No photo attached"))),r.a.createElement(ue.a,{container:!0,spacing:1,item:!0,xs:6},r.a.createElement(ue.a,{item:!0,xs:12},r.a.createElement(Pe.a,{variant:"h6"},o.text)),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},"Price:")),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},o.price)),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},"Email:")),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},o.email)),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},"Last Edit:")),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},o.editDate)),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},"Location:")),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},o.location)),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},"Status:")),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},o.status)),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},"Published on:")),r.a.createElement(ue.a,{item:!0,xs:6},r.a.createElement(Pe.a,{variant:"body2"},o.publishDate)))))},e}return a}(r.a.Component),Xe=Object(s.b)((function(e,t){return{user:Q(e)}}))(Ze),$e=a(119),Ke=a.n($e),et=function(e){var t=e.className;e.children;return r.a.createElement("div",{className:Object(H.a)(t,Ke.a.root)},r.a.createElement(Te,{title:"Page is not found"}))},tt=Object(s.b)((function(e){return{user:Q(e)}}))((function(e){var t=e.user;return r.a.createElement(ae.c,null,t.loggedIn&&r.a.createElement(ae.a,{exact:!0,path:"/userposts/:id",component:Re}),t.loggedIn&&r.a.createElement(ae.a,{exact:!0,path:"/post/add",component:Ie}),t.loggedIn&&r.a.createElement(ae.a,{exact:!0,path:"/post/:id/edit",component:Ce}),r.a.createElement(ae.a,{exact:!0,path:"/",component:Ge}),r.a.createElement(ae.a,{exact:!0,path:"/post/add",component:et}),r.a.createElement(ae.a,{exact:!0,path:"/post/:id",component:Xe}),r.a.createElement(ae.a,{path:"*",component:et}))})),at=Object(i.a)({palette:{primary:{main:"#2B4C6F"}}}),nt=function(){return r.a.createElement(s.a,{store:W},r.a.createElement(l.a,null,r.a.createElement(u.b,{injectFirst:!0},r.a.createElement(m.a,{theme:at},r.a.createElement(p.a,null),r.a.createElement(te,null,r.a.createElement(tt,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(242);o.a.render(r.a.createElement(nt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},26:function(e,t,a){e.exports={titlePaper:"Post_titlePaper__2OXTS",title:"Post_title__17nn2",image:"Post_image__1U6m1",hidden:"Post_hidden__2nCyz",visible:"Post_visible__gAH4z",placeholder:"Post_placeholder__CVPrl",edit:"Post_edit__1x3Zz"}},47:function(e,t,a){e.exports={root:"PageNav_root__bdF2f",link:"PageNav_link__1jSdq"}},68:function(e,t,a){e.exports={box:"SubmitPostForm_box__xjoG1"}},69:function(e,t,a){e.exports={titlePaper:"PageHeader_titlePaper__3SyUG",title:"PageHeader_title__M3hIP"}},70:function(e,t,a){e.exports={title:"PostsList_title__TwsZI"}}},[[132,1,2]]]);
//# sourceMappingURL=main.fc2ecedc.chunk.js.map